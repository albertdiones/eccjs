// Syntactic Sugar around SJCL's ECC Implementation - v0.1.0 - https://github.com/jpillora/eccjs
// Jaime Pillora <dev@jpillora.com> - MIT Copyright 2013
!function(a,b){"use strict";var c={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message},this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message},this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message},this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message},this.message=a}}};"undefined"!=typeof module&&module.exports&&(module.exports=c),c.cipher.aes=function(a){this._tables[0][0][0]||this._precompute();var b,d,e,f,g,h=this._tables[0][4],i=this._tables[1],j=a.length,k=1;if(4!==j&&6!==j&&8!==j)throw new c.exception.invalid("invalid aes key size");for(this._key=[f=a.slice(0),g=[]],b=j;4*j+28>b;b++)e=f[b-1],(b%j===0||8===j&&b%j===4)&&(e=h[e>>>24]<<24^h[e>>16&255]<<16^h[e>>8&255]<<8^h[255&e],b%j===0&&(e=e<<8^e>>>24^k<<24,k=k<<1^283*(k>>7))),f[b]=f[b-j]^e;for(d=0;b;d++,b--)e=f[3&d?b:b-4],g[d]=4>=b||4>d?e:i[0][h[e>>>24]]^i[1][h[e>>16&255]]^i[2][h[e>>8&255]]^i[3][h[255&e]]},c.cipher.aes.prototype={encrypt:function(a){return this._crypt(a,0)},decrypt:function(a){return this._crypt(a,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e,f,g,h,i,j=this._tables[0],k=this._tables[1],l=j[4],m=k[4],n=[],o=[];for(a=0;256>a;a++)o[(n[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!l[b];b^=d||1,c=o[c]||1)for(g=c^c<<1^c<<2^c<<3^c<<4,g=g>>8^255&g^99,l[b]=g,m[g]=b,f=n[e=n[d=n[b]]],i=16843009*f^65537*e^257*d^16843008*b,h=257*n[g]^16843008*g,a=0;4>a;a++)j[a][b]=h=h<<24^h>>>8,k[a][g]=i=i<<24^i>>>8;for(a=0;5>a;a++)j[a]=j[a].slice(0),k[a]=k[a].slice(0)},_crypt:function(a,b){if(4!==a.length)throw new c.exception.invalid("invalid aes block size");var d,e,f,g,h=this._key[b],i=a[0]^h[0],j=a[b?3:1]^h[1],k=a[2]^h[2],l=a[b?1:3]^h[3],m=h.length/4-2,n=4,o=[0,0,0,0],p=this._tables[b],q=p[0],r=p[1],s=p[2],t=p[3],u=p[4];for(g=0;m>g;g++)d=q[i>>>24]^r[j>>16&255]^s[k>>8&255]^t[255&l]^h[n],e=q[j>>>24]^r[k>>16&255]^s[l>>8&255]^t[255&i]^h[n+1],f=q[k>>>24]^r[l>>16&255]^s[i>>8&255]^t[255&j]^h[n+2],l=q[l>>>24]^r[i>>16&255]^s[j>>8&255]^t[255&k]^h[n+3],n+=4,i=d,j=e,k=f;for(g=0;4>g;g++)o[b?3&-g:g]=u[i>>>24]<<24^u[j>>16&255]<<16^u[k>>8&255]<<8^u[255&l]^h[n++],d=i,i=j,j=k,k=l,l=d;return o}},c.bitArray={bitSlice:function(a,d,e){return a=c.bitArray._shiftRight(a.slice(d/32),32-(31&d)).slice(1),e===b?a:c.bitArray.clamp(a,e-d)},extract:function(a,b,c){var d,e=Math.floor(-b-c&31);return d=-32&(b+c-1^b)?a[b/32|0]<<32-e^a[b/32+1|0]>>>e:a[b/32|0]>>>e,d&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var d=a[a.length-1],e=c.bitArray.getPartial(d);return 32===e?a.concat(b):c.bitArray._shiftRight(b,e,0|d,a.slice(0,a.length-1))},bitLength:function(a){var b,d=a.length;return 0===d?0:(b=a[d-1],32*(d-1)+c.bitArray.getPartial(b))},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var d=a.length;return b=31&b,d>0&&b&&(a[d-1]=c.bitArray.partial(b,a[d-1]&2147483648>>b-1,1)),a},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(c.bitArray.bitLength(a)!==c.bitArray.bitLength(b))return!1;var d,e=0;for(d=0;d<a.length;d++)e|=a[d]^b[d];return 0===e},_shiftRight:function(a,d,e,f){var g,h,i=0;for(f===b&&(f=[]);d>=32;d-=32)f.push(e),e=0;if(0===d)return f.concat(a);for(g=0;g<a.length;g++)f.push(e|a[g]>>>d),e=a[g]<<32-d;return i=a.length?a[a.length-1]:0,h=c.bitArray.getPartial(i),f.push(c.bitArray.partial(d+h&31,d+h>32?e:f.pop(),1)),f},_xor4:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}},c.codec.utf8String={fromBits:function(a){var b,d,e="",f=c.bitArray.bitLength(a);for(b=0;f/8>b;b++)0===(3&b)&&(d=a[b/4]),e+=String.fromCharCode(d>>>24),d<<=8;return decodeURIComponent(escape(e))},toBits:function(a){a=unescape(encodeURIComponent(a));var b,d=[],e=0;for(b=0;b<a.length;b++)e=e<<8|a.charCodeAt(b),3===(3&b)&&(d.push(e),e=0);return 3&b&&d.push(c.bitArray.partial(8*(3&b),e)),d}},c.codec.hex={fromBits:function(a){var b,d="";for(b=0;b<a.length;b++)d+=((0|a[b])+0xf00000000000).toString(16).substr(4);return d.substr(0,c.bitArray.bitLength(a)/4)},toBits:function(a){var b,d,e=[];for(a=a.replace(/\s|0x/g,""),d=a.length,a+="00000000",b=0;b<a.length;b+=8)e.push(0^parseInt(a.substr(b,8),16));return c.bitArray.clamp(e,4*d)}},c.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,d){var e,f="",g=0,h=c.codec.base64._chars,i=0,j=c.bitArray.bitLength(a);for(d&&(h=h.substr(0,62)+"-_"),e=0;6*f.length<j;)f+=h.charAt((i^a[e]>>>g)>>>26),6>g?(i=a[e]<<6-g,g+=26,e++):(i<<=6,g-=6);for(;3&f.length&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\s|=/g,"");var d,e,f=[],g=0,h=c.codec.base64._chars,i=0;for(b&&(h=h.substr(0,62)+"-_"),d=0;d<a.length;d++){if(e=h.indexOf(a.charAt(d)),0>e)throw new c.exception.invalid("this isn't base64!");g>26?(g-=26,f.push(i^e>>>g),i=e<<32-g):(g+=6,i^=e<<32-g)}return 56&g&&f.push(c.bitArray.partial(56&g,i,1)),f}},c.codec.base64url={fromBits:function(a){return c.codec.base64.fromBits(a,1,1)},toBits:function(a){return c.codec.base64.toBits(a,1)}},c.hash.sha256=function(a){this._key[0]||this._precompute(),a?(this._h=a._h.slice(0),this._buffer=a._buffer.slice(0),this._length=a._length):this.reset()},c.hash.sha256.hash=function(a){return(new c.hash.sha256).update(a).finalize()},c.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(a){"string"==typeof a&&(a=c.codec.utf8String.toBits(a));var b,d=this._buffer=c.bitArray.concat(this._buffer,a),e=this._length,f=this._length=e+c.bitArray.bitLength(a);for(b=512+e&-512;f>=b;b+=512)this._block(d.splice(0,16));return this},finalize:function(){var a,b=this._buffer,d=this._h;for(b=c.bitArray.concat(b,[c.bitArray.partial(1,1)]),a=b.length+2;15&a;a++)b.push(0);for(b.push(Math.floor(this._length/4294967296)),b.push(0|this._length);b.length;)this._block(b.splice(0,16));return this.reset(),d},_init:[],_key:[],_precompute:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}var b,c=0,d=2;a:for(;64>c;d++){for(b=2;d>=b*b;b++)if(d%b===0)continue a;8>c&&(this._init[c]=a(Math.pow(d,.5))),this._key[c]=a(Math.pow(d,1/3)),c++}},_block:function(a){var b,c,d,e,f=a.slice(0),g=this._h,h=this._key,i=g[0],j=g[1],k=g[2],l=g[3],m=g[4],n=g[5],o=g[6],p=g[7];for(b=0;64>b;b++)16>b?c=f[b]:(d=f[b+1&15],e=f[b+14&15],c=f[15&b]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[15&b]+f[b+9&15]|0),c=c+p+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(o^m&(n^o))+h[b],p=o,o=n,n=m,m=l+c|0,l=k,k=j,j=i,i=c+(j&k^l&(j^k))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0;g[0]=g[0]+i|0,g[1]=g[1]+j|0,g[2]=g[2]+k|0,g[3]=g[3]+l|0,g[4]=g[4]+m|0,g[5]=g[5]+n|0,g[6]=g[6]+o|0,g[7]=g[7]+p|0}},c.mode.ccm={name:"ccm",encrypt:function(a,b,d,e,f){var g,h,i=b.slice(0),j=c.bitArray,k=j.bitLength(d)/8,l=j.bitLength(i)/8;if(f=f||64,e=e||[],7>k)throw new c.exception.invalid("ccm: iv must be at least 7 bytes");for(g=2;4>g&&l>>>8*g;g++);return 15-k>g&&(g=15-k),d=j.clamp(d,8*(15-g)),h=c.mode.ccm._computeTag(a,b,d,e,f,g),i=c.mode.ccm._ctrMode(a,i,d,h,f,g),j.concat(i.data,i.tag)},decrypt:function(a,b,d,e,f){f=f||64,e=e||[];var g,h,i=c.bitArray,j=i.bitLength(d)/8,k=i.bitLength(b),l=i.clamp(b,k-f),m=i.bitSlice(b,k-f);if(k=(k-f)/8,7>j)throw new c.exception.invalid("ccm: iv must be at least 7 bytes");for(g=2;4>g&&k>>>8*g;g++);if(15-j>g&&(g=15-j),d=i.clamp(d,8*(15-g)),l=c.mode.ccm._ctrMode(a,l,d,m,f,g),h=c.mode.ccm._computeTag(a,l.data,d,e,f,g),!i.equal(l.tag,h))throw new c.exception.corrupt("ccm: tag doesn't match");return l.data},_computeTag:function(a,b,d,e,f,g){var h,i,j,k=[],l=c.bitArray,m=l._xor4;if(f/=8,f%2||4>f||f>16)throw new c.exception.invalid("ccm: invalid tag length");if(e.length>4294967295||b.length>4294967295)throw new c.exception.bug("ccm: can't deal with 4GiB or more data");if(h=[l.partial(8,(e.length?64:0)|f-2<<2|g-1)],h=l.concat(h,d),h[3]|=l.bitLength(b)/8,h=a.encrypt(h),e.length)for(i=l.bitLength(e)/8,65279>=i?k=[l.partial(16,i)]:4294967295>=i&&(k=l.concat([l.partial(16,65534)],[i])),k=l.concat(k,e),j=0;j<k.length;j+=4)h=a.encrypt(m(h,k.slice(j,j+4).concat([0,0,0])));for(j=0;j<b.length;j+=4)h=a.encrypt(m(h,b.slice(j,j+4).concat([0,0,0])));return l.clamp(h,8*f)},_ctrMode:function(a,b,d,e,f,g){var h,i,j,k=c.bitArray,l=k._xor4,m=b.length,n=k.bitLength(b);if(j=k.concat([k.partial(8,g-1)],d).concat([0,0,0]).slice(0,4),e=k.bitSlice(l(e,a.encrypt(j)),0,f),!m)return{tag:e,data:[]};for(i=0;m>i;i+=4)j[3]++,h=a.encrypt(j),b[i]^=h[0],b[i+1]^=h[1],b[i+2]^=h[2],b[i+3]^=h[3];return{tag:e,data:k.clamp(b,n)}}},c.mode.ocb2={name:"ocb2",encrypt:function(a,b,d,e,f,g){if(128!==c.bitArray.bitLength(d))throw new c.exception.invalid("ocb iv must be 128 bits");var h,i,j,k,l=c.mode.ocb2._times2,m=c.bitArray,n=m._xor4,o=[0,0,0,0],p=l(a.encrypt(d)),q=[];for(e=e||[],f=f||64,h=0;h+4<b.length;h+=4)i=b.slice(h,h+4),o=n(o,i),q=q.concat(n(p,a.encrypt(n(p,i)))),p=l(p);return i=b.slice(h),j=m.bitLength(i),k=a.encrypt(n(p,[0,0,0,j])),i=m.clamp(n(i.concat([0,0,0]),k),j),o=n(o,n(i.concat([0,0,0]),k)),o=a.encrypt(n(o,n(p,l(p)))),e.length&&(o=n(o,g?e:c.mode.ocb2.pmac(a,e))),q.concat(m.concat(i,m.clamp(o,f)))},decrypt:function(a,b,d,e,f,g){if(128!==c.bitArray.bitLength(d))throw new c.exception.invalid("ocb iv must be 128 bits");f=f||64;var h,i,j,k,l=c.mode.ocb2._times2,m=c.bitArray,n=m._xor4,o=[0,0,0,0],p=l(a.encrypt(d)),q=c.bitArray.bitLength(b)-f,r=[];for(e=e||[],h=0;q/32>h+4;h+=4)i=n(p,a.decrypt(n(p,b.slice(h,h+4)))),o=n(o,i),r=r.concat(i),p=l(p);if(j=q-32*h,k=a.encrypt(n(p,[0,0,0,j])),i=n(k,m.clamp(b.slice(h),j).concat([0,0,0])),o=n(o,i),o=a.encrypt(n(o,n(p,l(p)))),e.length&&(o=n(o,g?e:c.mode.ocb2.pmac(a,e))),!m.equal(m.clamp(o,f),m.bitSlice(b,q)))throw new c.exception.corrupt("ocb: tag doesn't match");return r.concat(m.clamp(i,j))},pmac:function(a,b){var d,e,f=c.mode.ocb2._times2,g=c.bitArray,h=g._xor4,i=[0,0,0,0],j=a.encrypt([0,0,0,0]);for(j=h(j,f(f(j))),d=0;d+4<b.length;d+=4)j=f(j),i=h(i,a.encrypt(h(j,b.slice(d,d+4))));return e=b.slice(d),g.bitLength(e)<128&&(j=h(j,f(j)),e=g.concat(e,[-2147483648,0,0,0])),i=h(i,e),a.encrypt(h(f(h(j,f(j))),i))},_times2:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}},c.mode.gcm={name:"gcm",encrypt:function(a,b,d,e,f){var g,h=b.slice(0),i=c.bitArray;return f=f||128,e=e||[],g=c.mode.gcm._ctrMode(!0,a,h,e,d,f),i.concat(g.data,g.tag)},decrypt:function(a,b,d,e,f){var g,h,i=b.slice(0),j=c.bitArray,k=j.bitLength(i);if(f=f||128,e=e||[],k>=f?(h=j.bitSlice(i,k-f),i=j.bitSlice(i,0,k-f)):(h=i,i=[]),g=c.mode.gcm._ctrMode(!1,a,i,e,d,f),!j.equal(g.tag,h))throw new c.exception.corrupt("gcm: tag doesn't match");return g.data},_galoisMultiply:function(a,b){var d,e,f,g,h,i,j=c.bitArray,k=j._xor4;for(g=[0,0,0,0],h=b.slice(0),d=0;128>d;d++){for(f=0!==(a[Math.floor(d/32)]&1<<31-d%32),f&&(g=k(g,h)),i=0!==(1&h[3]),e=3;e>0;e--)h[e]=h[e]>>>1|(1&h[e-1])<<31;h[0]=h[0]>>>1,i&&(h[0]=h[0]^225<<24)}return g},_ghash:function(a,b,d){var e,f,g=d.length;for(e=b.slice(0),f=0;g>f;f+=4)e[0]^=4294967295&d[f],e[1]^=4294967295&d[f+1],e[2]^=4294967295&d[f+2],e[3]^=4294967295&d[f+3],e=c.mode.gcm._galoisMultiply(e,a);return e},_ctrMode:function(a,b,d,e,f,g){{var h,i,j,k,l,m,n,o,p,q,r,s,t=c.bitArray;t._xor4}for(p=d.length,q=t.bitLength(d),r=t.bitLength(e),s=t.bitLength(f),h=b.encrypt([0,0,0,0]),96===s?(i=f.slice(0),i=t.concat(i,[1])):(i=c.mode.gcm._ghash(h,[0,0,0,0],f),i=c.mode.gcm._ghash(h,i,[0,0,Math.floor(s/4294967296),4294967295&s])),j=c.mode.gcm._ghash(h,[0,0,0,0],e),m=i.slice(0),n=j.slice(0),a||(n=c.mode.gcm._ghash(h,j,d)),l=0;p>l;l+=4)m[3]++,k=b.encrypt(m),d[l]^=k[0],d[l+1]^=k[1],d[l+2]^=k[2],d[l+3]^=k[3];return d=t.clamp(d,q),a&&(n=c.mode.gcm._ghash(h,j,d)),o=[Math.floor(r/4294967296),4294967295&r,Math.floor(q/4294967296),4294967295&q],n=c.mode.gcm._ghash(h,n,o),k=b.encrypt(i),n[0]^=k[0],n[1]^=k[1],n[2]^=k[2],n[3]^=k[3],{tag:t.bitSlice(n,0,g),data:d}}},c.misc.hmac=function(a,b){this._hash=b=b||c.hash.sha256;var d,e=[[],[]],f=b.prototype.blockSize/32;for(this._baseHash=[new b,new b],a.length>f&&(a=b.hash(a)),d=0;f>d;d++)e[0][d]=909522486^a[d],e[1][d]=1549556828^a[d];this._baseHash[0].update(e[0]),this._baseHash[1].update(e[1]),this._resultHash=new b(this._baseHash[0])},c.misc.hmac.prototype.encrypt=c.misc.hmac.prototype.mac=function(a){if(this._updated)throw new c.exception.invalid("encrypt on already updated hmac called!");return this.update(a),this.digest(a)},c.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},c.misc.hmac.prototype.update=function(a){this._updated=!0,this._resultHash.update(a)},c.misc.hmac.prototype.digest=function(){var a=this._resultHash.finalize(),b=new this._hash(this._baseHash[1]).update(a).finalize();return this.reset(),b},c.misc.pbkdf2=function(a,b,d,e,f){if(d=d||1e3,0>e||0>d)throw c.exception.invalid("invalid params to pbkdf2");"string"==typeof a&&(a=c.codec.utf8String.toBits(a)),"string"==typeof b&&(b=c.codec.utf8String.toBits(b)),f=f||c.misc.hmac;var g,h,i,j,k,l=new f(a),m=[],n=c.bitArray;for(k=1;32*m.length<(e||1);k++){for(g=h=l.encrypt(n.concat(b,[k])),i=1;d>i;i++)for(h=l.encrypt(h),j=0;j<h.length;j++)g[j]^=h[j];m=m.concat(g)}return e&&(m=n.clamp(m,e)),m},c.prng=function(a){this._pools=[new c.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=b,this._defaultParanoia=a,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},c.prng.prototype={randomWords:function(a,b){var d,e,f=[],g=this.isReady(b);if(g===this._NOT_READY)throw new c.exception.notReady("generator isn't seeded");for(g&this._REQUIRES_RESEED&&this._reseedFromPools(!(g&this._READY)),d=0;a>d;d+=4)(d+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),e=this._gen4words(),f.push(e[0],e[1],e[2],e[3]);return this._gate(),f.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=a},addEntropy:function(a,d,e){e=e||"user";var f,g,h,i,j=(new Date).valueOf(),k=this._robins[e],l=this.isReady(),m=0;switch(f=this._collectorIds[e],f===b&&(f=this._collectorIds[e]=this._collectorIdNext++),k===b&&(k=this._robins[e]=0),this._robins[e]=(this._robins[e]+1)%this._pools.length,typeof a){case"number":d===b&&(d=1),this._pools[k].update([f,this._eventId++,1,d,j,1,0|a]);break;case"object":if(i=Object.prototype.toString.call(a),"[object Uint32Array]"===i){for(h=[],g=0;g<a.length;g++)h.push(a[g]);a=h}else for("[object Array]"!==i&&(m=1),g=0;g<a.length&&!m;g++)"number"!=typeof a[g]&&(m=1);if(!m){if(d===b)for(d=0,g=0;g<a.length;g++)for(h=a[g];h>0;)d++,h>>>=1;this._pools[k].update([f,this._eventId++,2,d,j,a.length].concat(a))}break;case"string":d===b&&(d=a.length),this._pools[k].update([f,this._eventId++,3,d,j,a.length]),this._pools[k].update(a);break;default:m=1}if(m)throw new c.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[k]+=d,this._poolStrength+=d,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(a){var c=this._PARANOIA_LEVELS[a!==b?a:this._defaultParanoia];return this._strength&&this._strength>=c?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=c?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(a){var b=this._PARANOIA_LEVELS[a?a:this._defaultParanoia];return this._strength>=b?1:this._poolStrength>b?1:this._poolStrength/b},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector)},a.addEventListener)a.addEventListener("load",this._eventListener.loadTimeCollector,!1),a.addEventListener("mousemove",this._eventListener.mouseCollector,!1),a.addEventListener("keypress",this._eventListener.keyboardCollector,!1),a.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1);else{if(!document.attachEvent)throw new c.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(a.removeEventListener?(a.removeEventListener("load",this._eventListener.loadTimeCollector,!1),a.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),a.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),a.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(a,b){this._callbacks[a][this._callbackI++]=b},removeEventListener:function(a,b){var c,d,e=this._callbacks[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},_bind:function(a){var b=this;return function(){a.apply(b,arguments)}},_gen4words:function(){for(var a=0;4>a&&(this._counter[a]=this._counter[a]+1|0,!this._counter[a]);a++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new c.cipher.aes(this._key)},_reseed:function(a){this._key=c.hash.sha256.hash(this._key.concat(a)),this._cipher=new c.cipher.aes(this._key);for(var b=0;4>b&&(this._counter[b]=this._counter[b]+1|0,!this._counter[b]);b++);},_reseedFromPools:function(a){var b,d=[],e=0;for(this._nextReseed=d[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,b=0;16>b;b++)d.push(4294967296*Math.random()|0);for(b=0;b<this._pools.length&&(d=d.concat(this._pools[b].finalize()),e+=this._poolEntropy[b],this._poolEntropy[b]=0,a||!(this._reseedCount&1<<b));b++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new c.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=e,e>this._strength&&(this._strength=e),this._reseedCount++,this._reseed(d)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(a){var b=a.x||a.clientX||a.offsetX||0,d=a.y||a.clientY||a.offsetY||0;c.random.addEntropy([b,d],2,"mouse"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(b){a&&a.performance&&"function"==typeof a.performance.now?c.random.addEntropy(a.performance.now(),b,"loadtime"):c.random.addEntropy((new Date).valueOf(),b,"loadtime")},_accelerometerCollector:function(b){var d=b.accelerationIncludingGravity.x||b.accelerationIncludingGravity.y||b.accelerationIncludingGravity.z,e="";a.orientation&&(e=a.orientation),c.random.addEntropy([d,e],3,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(a,b){var d,e=c.random._callbacks[a],f=[];for(d in e)e.hasOwnProperty(d)&&f.push(e[d]);for(d=0;d<f.length;d++)f[d](b)}},c.random=new c.prng(6),function(){try{var b,d,e;if("undefined"!=typeof module&&module.exports&&(d=require("crypto"))&&d.randomBytes)b=d.randomBytes(128),c.random.addEntropy(b,1024,"crypto.randomBytes");else if(a&&Uint32Array){if(e=new Uint32Array(32),a.crypto&&a.crypto.getRandomValues)a.crypto.getRandomValues(e);else{if(!a.msCrypto||!a.msCrypto.getRandomValues)return;a.msCrypto.getRandomValues(e)}c.random.addEntropy(e,1024,"crypto.getRandomValues")}}catch(f){console.log("There was an error collecting entropy from the browser:"),console.log(f)}}(),c.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(a,b,d,e){d=d||{},e=e||{};var f,g,h,i=c.json,j=i._add({iv:c.random.randomWords(4,0)},i.defaults);if(i._add(j,d),h=j.adata,"string"==typeof j.salt&&(j.salt=c.codec.base64.toBits(j.salt)),"string"==typeof j.iv&&(j.iv=c.codec.base64.toBits(j.iv)),!c.mode[j.mode]||!c.cipher[j.cipher]||"string"==typeof a&&j.iter<=100||64!==j.ts&&96!==j.ts&&128!==j.ts||128!==j.ks&&192!==j.ks&&256!==j.ks||j.iv.length<2||j.iv.length>4)throw new c.exception.invalid("json encrypt: invalid parameters");return"string"==typeof a?(f=c.misc.cachedPbkdf2(a,j),a=f.key.slice(0,j.ks/32),j.salt=f.salt):c.ecc&&a instanceof c.ecc.elGamal.publicKey&&(f=a.kem(),j.kemtag=f.tag,a=f.key.slice(0,j.ks/32)),"string"==typeof b&&(b=c.codec.utf8String.toBits(b)),"string"==typeof h&&(h=c.codec.utf8String.toBits(h)),g=new c.cipher[j.cipher](a),i._add(e,j),e.key=a,j.ct=c.mode[j.mode].encrypt(g,b,j.iv,h,j.ts),j},encrypt:function(){var a=c.json,b=a._encrypt.apply(a,arguments);return a.encode(b)},_decrypt:function(a,b,d,e){d=d||{},e=e||{};var f,g,h,i=c.json,j=i._add(i._add(i._add({},i.defaults),b),d,!0),k=j.adata;if("string"==typeof j.salt&&(j.salt=c.codec.base64.toBits(j.salt)),"string"==typeof j.iv&&(j.iv=c.codec.base64.toBits(j.iv)),!c.mode[j.mode]||!c.cipher[j.cipher]||"string"==typeof a&&j.iter<=100||64!==j.ts&&96!==j.ts&&128!==j.ts||128!==j.ks&&192!==j.ks&&256!==j.ks||!j.iv||j.iv.length<2||j.iv.length>4)throw new c.exception.invalid("json decrypt: invalid parameters");return"string"==typeof a?(g=c.misc.cachedPbkdf2(a,j),a=g.key.slice(0,j.ks/32),j.salt=g.salt):c.ecc&&a instanceof c.ecc.elGamal.secretKey&&(a=a.unkem(c.codec.base64.toBits(j.kemtag)).slice(0,j.ks/32)),"string"==typeof k&&(k=c.codec.utf8String.toBits(k)),h=new c.cipher[j.cipher](a),f=c.mode[j.mode].decrypt(h,j.ct,j.iv,k,j.ts),i._add(e,j),e.key=a,c.codec.utf8String.fromBits(f)},decrypt:function(a,b,d,e){var f=c.json;return f._decrypt(a,f.decode(b),d,e)},encode:function(a){var b,d="{",e="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new c.exception.invalid("json encode: invalid property name");switch(d+=e+'"'+b+'":',e=",",typeof a[b]){case"number":case"boolean":d+=a[b];break;case"string":d+='"'+escape(a[b])+'"';break;case"object":d+='"'+c.codec.base64.fromBits(a[b],0)+'"';break;default:throw new c.exception.bug("json encode: unsupported type")}}return d+"}"},decode:function(a){if(a=a.replace(/\s/g,""),!a.match(/^\{.*\}$/))throw new c.exception.invalid("json decode: this isn't json!");var b,d,e=a.replace(/^\{|\}$/g,"").split(/,/),f={};for(b=0;b<e.length;b++){if(!(d=e[b].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new c.exception.invalid("json decode: this isn't json!");f[d[2]]=d[3]?parseInt(d[3],10):d[2].match(/^(ct|salt|iv)$/)?c.codec.base64.toBits(d[4]):unescape(d[4])}return f},_add:function(a,d,e){if(a===b&&(a={}),d===b)return a;var f;for(f in d)if(d.hasOwnProperty(f)){if(e&&a[f]!==b&&a[f]!==d[f])throw new c.exception.invalid("required parameter overridden");a[f]=d[f]}return a},_subtract:function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&a[c]!==b[c]&&(d[c]=a[c]);return d},_filter:function(a,c){var d,e={};for(d=0;d<c.length;d++)a[c[d]]!==b&&(e[c[d]]=a[c[d]]);return e}},c.encrypt=c.json.encrypt,c.decrypt=c.json.decrypt,c.misc._pbkdf2Cache={},c.misc.cachedPbkdf2=function(a,d){var e,f,g,h,i=c.misc._pbkdf2Cache;return d=d||{},h=d.iter||1e3,f=i[a]=i[a]||{},e=f[h]=f[h]||{firstSalt:d.salt&&d.salt.length?d.salt.slice(0):c.random.randomWords(2,0)},g=d.salt===b?e.firstSalt:d.salt,e[g]=e[g]||c.misc.pbkdf2(a,g,d.iter),{key:e[g].slice(0),salt:g.slice(0)}},c.bn=function(a){this.initWith(a)},c.bn.prototype={radix:24,maxMul:8,_class:c.bn,copy:function(){return new this._class(this)},initWith:function(a){var b,c=0;switch(typeof a){case"object":this.limbs=a.limbs.slice(0);break;case"number":this.limbs=[a],this.normalize();break;case"string":for(a=a.replace(/^0x/,""),this.limbs=[],b=this.radix/4,c=0;c<a.length;c+=b)this.limbs.push(parseInt(a.substring(Math.max(a.length-c-b,0),a.length-c),16));break;default:this.limbs=[0]}return this},equals:function(a){"number"==typeof a&&(a=new this._class(a));var b,c=0;for(this.fullReduce(),a.fullReduce(),b=0;b<this.limbs.length||b<a.limbs.length;b++)c|=this.getLimb(b)^a.getLimb(b);return 0===c},getLimb:function(a){return a>=this.limbs.length?0:this.limbs[a]},greaterEquals:function(a){"number"==typeof a&&(a=new this._class(a));var b,c,d,e=0,f=0;for(b=Math.max(this.limbs.length,a.limbs.length)-1;b>=0;b--)c=this.getLimb(b),d=a.getLimb(b),f|=d-c&~e,e|=c-d&~f;return(f|~e)>>>31},toString:function(){this.fullReduce();var a,b,c="",d=this.limbs;for(a=0;a<this.limbs.length;a++){for(b=d[a].toString(16);a<this.limbs.length-1&&b.length<6;)b="0"+b;c=b+c}return"0x"+c},addM:function(a){"object"!=typeof a&&(a=new this._class(a));var b,c=this.limbs,d=a.limbs;for(b=c.length;b<d.length;b++)c[b]=0;for(b=0;b<d.length;b++)c[b]+=d[b];return this},doubleM:function(){var a,b,c=0,d=this.radix,e=this.radixMask,f=this.limbs;for(a=0;a<f.length;a++)b=f[a],b=b+b+c,f[a]=b&e,c=b>>d;return c&&f.push(c),this},halveM:function(){var a,b,c=0,d=this.radix,e=this.limbs;for(a=e.length-1;a>=0;a--)b=e[a],e[a]=b+c>>1,c=(1&b)<<d;return e[e.length-1]||e.pop(),this},subM:function(a){"object"!=typeof a&&(a=new this._class(a));var b,c=this.limbs,d=a.limbs;for(b=c.length;b<d.length;b++)c[b]=0;for(b=0;b<d.length;b++)c[b]-=d[b];return this},mod:function(a){var b=!this.greaterEquals(new c.bn(0));a=new c.bn(a).normalize();var d=new c.bn(this).normalize(),e=0;for(b&&(d=new c.bn(0).subM(d).normalize());d.greaterEquals(a);e++)a.doubleM();for(b&&(d=a.sub(d).normalize());e>0;e--)a.halveM(),d.greaterEquals(a)&&d.subM(a).normalize();return d.trim()},inverseMod:function(a){var b,d,e=new c.bn(1),f=new c.bn(0),g=new c.bn(this),h=new c.bn(a),i=1;if(!(1&a.limbs[0]))throw new c.exception.invalid("inverseMod: p must be odd");do for(1&g.limbs[0]&&(g.greaterEquals(h)||(b=g,g=h,h=b,b=e,e=f,f=b),g.subM(h),g.normalize(),e.greaterEquals(f)||e.addM(a),e.subM(f)),g.halveM(),1&e.limbs[0]&&e.addM(a),e.normalize(),e.halveM(),d=i=0;d<g.limbs.length;d++)i|=g.limbs[d];while(i);if(!h.equals(1))throw new c.exception.invalid("inverseMod: p and x must be relatively prime");return f},add:function(a){return this.copy().addM(a)},sub:function(a){return this.copy().subM(a)},mul:function(a){"number"==typeof a&&(a=new this._class(a));var b,c,d,e=this.limbs,f=a.limbs,g=e.length,h=f.length,i=new this._class,j=i.limbs,k=this.maxMul;for(b=0;b<this.limbs.length+a.limbs.length+1;b++)j[b]=0;for(b=0;g>b;b++){for(d=e[b],c=0;h>c;c++)j[b+c]+=d*f[c];--k||(k=this.maxMul,i.cnormalize())}return i.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(a){"number"==typeof a?a=[a]:a.limbs!==b&&(a=a.normalize().limbs);var c,d,e=new this._class(1),f=this;for(c=0;c<a.length;c++)for(d=0;d<this.radix;d++)a[c]&1<<d&&(e=e.mul(f)),f=f.square();return e},mulmod:function(a,b){return this.mod(b).mul(a.mod(b)).mod(b)},powermod:function(a,b){for(var d=new c.bn(1),e=new c.bn(this),f=new c.bn(a);;){if(1&f.limbs[0]&&(d=d.mulmod(e,b)),f.halveM(),f.equals(0))break;e=e.mulmod(e,b)}return d.normalize().reduce()},trim:function(){var a,b=this.limbs;do a=b.pop();while(b.length&&0===a);return b.push(a),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var a,b,c,d=0,e=(this.placeVal,this.ipv),f=this.limbs,g=f.length,h=this.radixMask;for(a=0;g>a||0!==d&&-1!==d;a++)b=(f[a]||0)+d,c=f[a]=b&h,d=(b-c)*e;return-1===d&&(f[a-1]-=this.placeVal),this},cnormalize:function(){var a,b,c,d=0,e=this.ipv,f=this.limbs,g=f.length,h=this.radixMask;for(a=0;g-1>a;a++)b=f[a]+d,c=f[a]=b&h,d=(b-c)*e;return f[a]+=d,this},toBits:function(a){this.fullReduce(),a=a||this.exponent||this.bitLength();var b=Math.floor((a-1)/24),d=c.bitArray,e=(a+7&-8)%this.radix||this.radix,f=[d.partial(e,this.getLimb(b))];for(b--;b>=0;b--)f=d.concat(f,[d.partial(Math.min(this.radix,a),this.getLimb(b))]),a-=this.radix;return f},bitLength:function(){this.fullReduce();for(var a=this.radix*(this.limbs.length-1),b=this.limbs[this.limbs.length-1];b;b>>>=1)a++;return a+7&-8}},c.bn.fromBits=function(a){var b=this,d=new b,e=[],f=c.bitArray,g=this.prototype,h=Math.min(this.bitLength||4294967296,f.bitLength(a)),i=h%g.radix||g.radix;for(e[0]=f.extract(a,0,i);h>i;i+=g.radix)e.unshift(f.extract(a,i,g.radix));return d.limbs=e,d},c.bn.prototype.ipv=1/(c.bn.prototype.placeVal=Math.pow(2,c.bn.prototype.radix)),c.bn.prototype.radixMask=(1<<c.bn.prototype.radix)-1,c.bn.pseudoMersennePrime=function(a,b){function d(a){this.initWith(a)}var e,f,g,h=d.prototype=new c.bn;for(g=h.modOffset=Math.ceil(f=a/h.radix),h.exponent=a,h.offset=[],h.factor=[],h.minOffset=g,h.fullMask=0,h.fullOffset=[],h.fullFactor=[],h.modulus=d.modulus=new c.bn(Math.pow(2,a)),h.fullMask=0|-Math.pow(2,a%h.radix),e=0;e<b.length;e++)h.offset[e]=Math.floor(b[e][0]/h.radix-f),h.fullOffset[e]=Math.ceil(b[e][0]/h.radix-f),h.factor[e]=b[e][1]*Math.pow(.5,a-b[e][0]+h.offset[e]*h.radix),h.fullFactor[e]=b[e][1]*Math.pow(.5,a-b[e][0]+h.fullOffset[e]*h.radix),h.modulus.addM(new c.bn(Math.pow(2,b[e][0])*b[e][1])),h.minOffset=Math.min(h.minOffset,-h.offset[e]);return h._class=d,h.modulus.cnormalize(),h.reduce=function(){var a,b,c,d,e=this.modOffset,f=this.limbs,g=this.offset,h=this.offset.length,i=this.factor;for(a=this.minOffset;f.length>e;){for(c=f.pop(),d=f.length,b=0;h>b;b++)f[d+g[b]]-=i[b]*c;a--,a||(f.push(0),this.cnormalize(),a=this.minOffset)}return this.cnormalize(),this},h._strongReduce=-1===h.fullMask?h.reduce:function(){var a,b,c=this.limbs,d=c.length-1;if(this.reduce(),d===this.modOffset-1){for(b=c[d]&this.fullMask,c[d]-=b,a=0;a<this.fullOffset.length;a++)c[d+this.fullOffset[a]]-=this.fullFactor[a]*b;this.normalize()}},h.fullReduce=function(){var a,b;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),b=this.limbs.length;b<this.modOffset;b++)this.limbs[b]=0;for(a=this.greaterEquals(this.modulus),b=0;b<this.limbs.length;b++)this.limbs[b]-=this.modulus.limbs[b]*a;return this.cnormalize(),this},h.inverse=function(){return this.power(this.modulus.sub(2))},d.fromBits=c.bn.fromBits,d};var d=c.bn.pseudoMersennePrime;c.bn.prime={p127:d(127,[[0,-1]]),p25519:d(255,[[0,-19]]),p192k:d(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:d(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:d(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:d(192,[[0,-1],[64,-1]]),p224:d(224,[[0,1],[96,-1]]),p256:d(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:d(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:d(521,[[0,-1]])},c.bn.random=function(a,b){"object"!=typeof a&&(a=new c.bn(a));for(var d,e,f=a.limbs.length,g=a.limbs[f-1]+1,h=new c.bn;;){do d=c.random.randomWords(f,b),d[f-1]<0&&(d[f-1]+=4294967296);while(Math.floor(d[f-1]/g)===Math.floor(4294967296/g));for(d[f-1]%=g,e=0;f-1>e;e++)d[e]&=a.radixMask;if(h.limbs=d,!h.greaterEquals(a))return h}},c.ecc={},c.ecc.point=function(a,c,d){c===b?this.isIdentity=!0:(this.x=c,this.y=d,this.isIdentity=!1),this.curve=a},c.ecc.point.prototype={toJac:function(){return new c.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(a){return this.toJac().mult(a,this).toAffine()},mult2:function(a,b,c){return this.toJac().mult2(a,this,b,c).toAffine()},multiples:function(){var a,d,e;if(this._multiples===b)for(e=this.toJac().doubl(),a=this._multiples=[new c.ecc.point(this.curve),this,e.toAffine()],d=3;16>d;d++)e=e.add(this),a.push(e.toAffine());
return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return c.bitArray.concat(this.x.toBits(),this.y.toBits())}},c.ecc.pointJac=function(a,c,d,e){c===b?this.isIdentity=!0:(this.x=c,this.y=d,this.z=e,this.isIdentity=!1),this.curve=a},c.ecc.pointJac.prototype={add:function(a){var b,d,e,f,g,h,i,j,k,l,m,n=this;if(n.curve!==a.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return n.isIdentity?a.toJac():a.isIdentity?n:(b=n.z.square(),d=a.x.mul(b).subM(n.x),d.equals(0)?n.y.equals(a.y.mul(b.mul(n.z)))?n.doubl():new c.ecc.pointJac(n.curve):(e=a.y.mul(b.mul(n.z)).subM(n.y),f=d.square(),g=e.square(),h=d.square().mul(d).addM(n.x.add(n.x).mul(f)),i=g.subM(h),j=n.x.mul(f).subM(i).mul(e),k=n.y.mul(d.square().mul(d)),l=j.subM(k),m=n.z.mul(d),new c.ecc.pointJac(this.curve,i,l,m)))},doubl:function(){if(this.isIdentity)return this;var a=this.y.square(),b=a.mul(this.x.mul(4)),d=a.square().mul(8),e=this.z.square(),f=this.curve.a.toString()==new c.bn(-3).toString()?this.x.sub(e).mul(3).mul(this.x.add(e)):this.x.square().mul(3).add(e.square().mul(this.curve.a)),g=f.square().subM(b).subM(b),h=b.sub(g).mul(f).subM(d),i=this.y.add(this.y).mul(this.z);return new c.ecc.pointJac(this.curve,g,h,i)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new c.ecc.point(this.curve);var a=this.z.inverse(),b=a.square();return new c.ecc.point(this.curve,this.x.mul(b).fullReduce(),this.y.mul(b.mul(a)).fullReduce())},mult:function(a,d){"number"==typeof a?a=[a]:a.limbs!==b&&(a=a.normalize().limbs);var e,f,g=new c.ecc.point(this.curve).toJac(),h=d.multiples();for(e=a.length-1;e>=0;e--)for(f=c.bn.prototype.radix-4;f>=0;f-=4)g=g.doubl().doubl().doubl().doubl().add(h[a[e]>>f&15]);return g},mult2:function(a,d,e,f){"number"==typeof a?a=[a]:a.limbs!==b&&(a=a.normalize().limbs),"number"==typeof e?e=[e]:e.limbs!==b&&(e=e.normalize().limbs);var g,h,i,j,k=new c.ecc.point(this.curve).toJac(),l=d.multiples(),m=f.multiples();for(g=Math.max(a.length,e.length)-1;g>=0;g--)for(i=0|a[g],j=0|e[g],h=c.bn.prototype.radix-4;h>=0;h-=4)k=k.doubl().doubl().doubl().doubl().add(l[i>>h&15]).add(m[j>>h&15]);return k},isValid:function(){var a=this.z.square(),b=a.square(),c=b.mul(a);return this.y.square().equals(this.curve.b.mul(c).add(this.x.mul(this.curve.a.mul(b).add(this.x.square()))))}},c.ecc.curve=function(a,b,d,e,f,g){this.field=a,this.r=new c.bn(b),this.a=new a(d),this.b=new a(e),this.G=new c.ecc.point(this,new a(f),new a(g))},c.ecc.curve.prototype.fromBits=function(a){var b=c.bitArray,d=this.field.prototype.exponent+7&-8,e=new c.ecc.point(this,this.field.fromBits(b.bitSlice(a,0,d)),this.field.fromBits(b.bitSlice(a,d,2*d)));if(!e.isValid())throw new c.exception.corrupt("not on the curve!");return e},c.ecc.curves={c192:new c.ecc.curve(c.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new c.ecc.curve(c.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new c.ecc.curve(c.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new c.ecc.curve(c.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),k192:new c.ecc.curve(c.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),k224:new c.ecc.curve(c.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new c.ecc.curve(c.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},c.ecc.basicKey={publicKey:function(a,b){this._curve=a,this._curveBitLength=a.r.bitLength(),this._point=b instanceof Array?a.fromBits(b):b,this.get=function(){var a=this._point.toBits(),b=c.bitArray.bitLength(a),d=c.bitArray.bitSlice(a,0,b/2),e=c.bitArray.bitSlice(a,b/2);return{x:d,y:e}}},secretKey:function(a,b){this._curve=a,this._curveBitLength=a.r.bitLength(),this._exponent=b,this.get=function(){return this._exponent.toBits()}}},c.ecc.basicKey.generateKeys=function(a){return function(d,e,f){if(d=d||256,e=e||0,"number"==typeof d&&(d=c.ecc.curves["c"+d],d===b))throw new c.exception.invalid("no such curve");f=f||c.bn.random(d.r,e);var g=d.G.mult(f);return{pub:new c.ecc[a].publicKey(d,g),sec:new c.ecc[a].secretKey(d,f)}}},c.ecc.elGamal={generateKeys:c.ecc.basicKey.generateKeys("elGamal"),publicKey:function(){c.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(){c.ecc.basicKey.secretKey.apply(this,arguments)}},c.ecc.elGamal.publicKey.prototype={kem:function(a){var b=c.bn.random(this._curve.r,a),d=this._curve.G.mult(b).toBits(),e=c.hash.sha256.hash(this._point.mult(b).toBits());return{key:e,tag:d}}},c.ecc.elGamal.secretKey.prototype={unkem:function(a){return c.hash.sha256.hash(this._curve.fromBits(a).mult(this._exponent).toBits())},dh:function(a){return c.hash.sha256.hash(a._point.mult(this._exponent).toBits())}},c.ecc.ecdsa={generateKeys:c.ecc.basicKey.generateKeys("ecdsa")},c.ecc.ecdsa.publicKey=function(){c.ecc.basicKey.publicKey.apply(this,arguments)},c.ecc.ecdsa.publicKey.prototype={verify:function(a,d,e){c.bitArray.bitLength(a)>this._curveBitLength&&(a=c.bitArray.clamp(a,this._curveBitLength));var f=c.bitArray,g=this._curve.r,h=this._curveBitLength,i=c.bn.fromBits(f.bitSlice(d,0,h)),j=c.bn.fromBits(f.bitSlice(d,h,2*h)),k=e?j:j.inverseMod(g),l=c.bn.fromBits(a).mul(k).mod(g),m=i.mul(k).mod(g),n=this._curve.G.mult2(l,m,this._point).x;if(i.equals(0)||j.equals(0)||i.greaterEquals(g)||j.greaterEquals(g)||!n.equals(i)){if(e===b)return this.verify(a,d,!0);throw new c.exception.corrupt("signature didn't check out")}return!0}},c.ecc.ecdsa.secretKey=function(){c.ecc.basicKey.secretKey.apply(this,arguments)},c.ecc.ecdsa.secretKey.prototype={sign:function(a,b,d,e){c.bitArray.bitLength(a)>this._curveBitLength&&(a=c.bitArray.clamp(a,this._curveBitLength));var f=this._curve.r,g=f.bitLength(),h=e||c.bn.random(f.sub(1),b).add(1),i=this._curve.G.mult(h).x.mod(f),j=c.bn.fromBits(a).add(i.mul(this._exponent)),k=d?j.inverseMod(f).mul(h).mod(f):j.mul(h.inverseMod(f)).mod(f);return c.bitArray.concat(i.toBits(g),k.toBits(g))}},console.log(42)}(this);